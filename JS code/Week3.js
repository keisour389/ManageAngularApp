var tableCustomer = {
  JSONData: [
    {
      Name: "Otto Clay",
      Age: 61,
      Country: 6,
      Address: "Ap #897-1459 Quam Avenue",
      Married: false
    },
    {
      Name: "Connor Johnston",
      Age: 73,
      Country: 7,
      Address: "Ap #370-4647 Dis Av.",
      Married: false
    },
    {
      Name: "Lacey Hess",
      Age: 29,
      Country: 7,
      Address: "Ap #365-8835 Integer St.",
      Married: false
    },
    {
      Name: "Timothy Henson",
      Age: 78,
      Country: 1,
      Address: "911-5143 Luctus Ave",
      Married: false
    },
    {
      Name: "Ramona Benton",
      Age: 43,
      Country: 5,
      Address: "Ap #614-689 Vehicula Street",
      Married: true
    },
    {
      Name: "Ezra Tillman",
      Age: 51,
      Country: 1,
      Address: "P.O. Box 738, 7583 Quisque St.",
      Married: true
    },
    {
      Name: "Dante Carter",
      Age: 59,
      Country: 1,
      Address: "P.O. Box 976, 6316 Lorem, St.",
      Married: false
    },
    {
      Name: "Christopher Mcclure",
      Age: 58,
      Country: 1,
      Address: "847-4303 Dictum Av.",
      Married: true
    },
    {
      Name: "Ruby Rocha",
      Age: 62,
      Country: 2,
      Address: "5212 Sagittis Ave",
      Married: false
    },
    {
      Name: "Imelda Hardin",
      Age: 39,
      Country: 5,
      Address: "719-7009 Auctor Av.",
      Married: false
    },
    {
      Name: "Jonah Johns",
      Age: 28,
      Country: 5,
      Address: "P.O. Box 939, 9310 A Ave",
      Married: false
    },
    {
      Name: "Herman Rosa",
      Age: 49,
      Country: 7,
      Address: "718-7162 Molestie Av.",
      Married: true
    },
    {
      Name: "Arthur Gay",
      Age: 20,
      Country: 7,
      Address: "5497 Neque Street",
      Married: false
    },
    {
      Name: "Xena Wilkerson",
      Age: 63,
      Country: 1,
      Address: "Ap #303-6974 Proin Street",
      Married: true
    },
    {
      Name: "Lilah Atkins",
      Age: 33,
      Country: 5,
      Address: "622-8602 Gravida Ave",
      Married: true
    },
    {
      Name: "Malik Shepard",
      Age: 59,
      Country: 1,
      Address: "967-5176 Tincidunt Av.",
      Married: false
    },
    {
      Name: "Keely Silva",
      Age: 24,
      Country: 1,
      Address: "P.O. Box 153, 8995 Praesent Ave",
      Married: false
    },
    {
      Name: "Hunter Pate",
      Age: 73,
      Country: 7,
      Address: "P.O. Box 771, 7599 Ante, Road",
      Married: false
    },
    {
      Name: "Mikayla Roach",
      Age: 55,
      Country: 5,
      Address: "Ap #438-9886 Donec Rd.",
      Married: true
    },
    {
      Name: "Upton Joseph",
      Age: 48,
      Country: 4,
      Address: "Ap #896-7592 Habitant St.",
      Married: true
    },
    {
      Name: "Jeanette Pate",
      Age: 59,
      Country: 2,
      Address: "P.O. Box 177, 7584 Amet, St.",
      Married: false
    },
    {
      Name: "Kaden Hernandez",
      Age: 79,
      Country: 3,
      Address: "366 Ut St.",
      Married: true
    },
    {
      Name: "Kenyon Stevens",
      Age: 20,
      Country: 3,
      Address: "P.O. Box 704, 4580 Gravida Rd.",
      Married: false
    },
    {
      Name: "Jerome Harper",
      Age: 31,
      Country: 5,
      Address: "2464 Porttitor Road",
      Married: false
    },
    {
      Name: "Jelani Patel",
      Age: 36,
      Country: 2,
      Address: "P.O. Box 541, 5805 Nec Av.",
      Married: true
    },
    {
      Name: "Keaton Oconnor",
      Age: 21,
      Country: 1,
      Address: "Ap #657-1093 Nec, Street",
      Married: false
    },
    {
      Name: "Bree Johnston",
      Age: 31,
      Country: 2,
      Address: "372-5942 Vulputate Avenue",
      Married: false
    },
    {
      Name: "Maisie Hodges",
      Age: 70,
      Country: 7,
      Address: "P.O. Box 445, 3880 Odio, Rd.",
      Married: false
    },
    {
      Name: "Kuame Calhoun",
      Age: 39,
      Country: 2,
      Address: "P.O. Box 609, 4105 Rutrum St.",
      Married: true
    },
    {
      Name: "Carlos Cameron",
      Age: 38,
      Country: 5,
      Address: "Ap #215-5386 A, Avenue",
      Married: false
    },
    {
      Name: "Fulton Parsons",
      Age: 25,
      Country: 7,
      Address: "P.O. Box 523, 3705 Sed Rd.",
      Married: false
    },
    {
      Name: "Wallace Christian",
      Age: 43,
      Country: 3,
      Address: "416-8816 Mauris Avenue",
      Married: true
    },
    {
      Name: "Caryn Maldonado",
      Age: 40,
      Country: 1,
      Address: "108-282 Nonummy Ave",
      Married: false
    },
    {
      Name: "Whilemina Frank",
      Age: 20,
      Country: 7,
      Address: "P.O. Box 681, 3938 Egestas. Av.",
      Married: true
    },
    {
      Name: "Emery Moon",
      Age: 41,
      Country: 4,
      Address: "Ap #717-8556 Non Road",
      Married: true
    },
    {
      Name: "Price Watkins",
      Age: 35,
      Country: 4,
      Address: "832-7810 Nunc Rd.",
      Married: false
    },
    {
      Name: "Lydia Castillo",
      Age: 59,
      Country: 7,
      Address: "5280 Placerat, Ave",
      Married: true
    },
    {
      Name: "Lawrence Conway",
      Age: 53,
      Country: 1,
      Address: "Ap #452-2808 Imperdiet St.",
      Married: false
    },
    {
      Name: "Kalia Nicholson",
      Age: 67,
      Country: 5,
      Address: "P.O. Box 871, 3023 Tellus Road",
      Married: true
    },
    {
      Name: "Brielle Baxter",
      Age: 45,
      Country: 3,
      Address: "Ap #822-9526 Ut, Road",
      Married: true
    },
    {
      Name: "Valentine Brady",
      Age: 72,
      Country: 7,
      Address: "8014 Enim. Road",
      Married: true
    },
    {
      Name: "Rebecca Gardner",
      Age: 57,
      Country: 4,
      Address: "8655 Arcu. Road",
      Married: true
    },
    {
      Name: "Vladimir Tate",
      Age: 26,
      Country: 1,
      Address: "130-1291 Non, Rd.",
      Married: true
    },
    {
      Name: "Vernon Hays",
      Age: 56,
      Country: 4,
      Address: "964-5552 In Rd.",
      Married: true
    },
    {
      Name: "Allegra Hull",
      Age: 22,
      Country: 4,
      Address: "245-8891 Donec St.",
      Married: true
    },
    {
      Name: "Hu Hendrix",
      Age: 65,
      Country: 7,
      Address: "428-5404 Tempus Ave",
      Married: true
    },
    {
      Name: "Kenyon Battle",
      Age: 32,
      Country: 2,
      Address: "921-6804 Lectus St.",
      Married: false
    },
    {
      Name: "Gloria Nielsen",
      Age: 24,
      Country: 4,
      Address: "Ap #275-4345 Lorem, Street",
      Married: true
    },
    {
      Name: "Illiana Kidd",
      Age: 59,
      Country: 2,
      Address: "7618 Lacus. Av.",
      Married: false
    },
    {
      Name: "Adria Todd",
      Age: 68,
      Country: 6,
      Address: "1889 Tincidunt Road",
      Married: false
    },
    {
      Name: "Kirsten Mayo",
      Age: 71,
      Country: 1,
      Address: "100-8640 Orci, Avenue",
      Married: false
    },
    {
      Name: "Willa Hobbs",
      Age: 60,
      Country: 6,
      Address: "P.O. Box 323, 158 Tristique St.",
      Married: false
    },
    {
      Name: "Alexis Clements",
      Age: 69,
      Country: 5,
      Address: "P.O. Box 176, 5107 Proin Rd.",
      Married: false
    },
    {
      Name: "Akeem Conrad",
      Age: 60,
      Country: 2,
      Address: "282-495 Sed Ave",
      Married: true
    },
    {
      Name: "Montana Silva",
      Age: 79,
      Country: 6,
      Address: "P.O. Box 120, 9766 Consectetuer St.",
      Married: false
    },
    {
      Name: "Kaseem Hensley",
      Age: 77,
      Country: 6,
      Address: "Ap #510-8903 Mauris. Av.",
      Married: true
    },
    {
      Name: "Christopher Morton",
      Age: 35,
      Country: 5,
      Address: "P.O. Box 234, 3651 Sodales Avenue",
      Married: false
    },
    {
      Name: "Wade Fernandez",
      Age: 49,
      Country: 6,
      Address: "740-5059 Dolor. Road",
      Married: true
    },
    {
      Name: "Illiana Kirby",
      Age: 31,
      Country: 2,
      Address: "527-3553 Mi Ave",
      Married: false
    },
    {
      Name: "Kimberley Hurley",
      Age: 65,
      Country: 5,
      Address: "P.O. Box 637, 9915 Dictum St.",
      Married: false
    },
    {
      Name: "Arthur Olsen",
      Age: 74,
      Country: 5,
      Address: "887-5080 Eget St.",
      Married: false
    },
    {
      Name: "Brody Potts",
      Age: 59,
      Country: 2,
      Address: "Ap #577-7690 Sem Road",
      Married: false
    },
    {
      Name: "Dillon Ford",
      Age: 60,
      Country: 1,
      Address: "Ap #885-9289 A, Av.",
      Married: true
    },
    {
      Name: "Hannah Juarez",
      Age: 61,
      Country: 2,
      Address: "4744 Sapien, Rd.",
      Married: true
    },
    {
      Name: "Vincent Shaffer",
      Age: 25,
      Country: 2,
      Address: "9203 Nunc St.",
      Married: true
    },
    {
      Name: "George Holt",
      Age: 27,
      Country: 6,
      Address: "4162 Cras Rd.",
      Married: false
    },
    {
      Name: "Tobias Bartlett",
      Age: 74,
      Country: 4,
      Address: "792-6145 Mauris St.",
      Married: true
    },
    {
      Name: "Xavier Hooper",
      Age: 35,
      Country: 1,
      Address: "879-5026 Interdum. Rd.",
      Married: false
    },
    {
      Name: "Declan Dorsey",
      Age: 31,
      Country: 2,
      Address: "Ap #926-4171 Aenean Road",
      Married: true
    },
    {
      Name: "Clementine Tran",
      Age: 43,
      Country: 4,
      Address: "P.O. Box 176, 9865 Eu Rd.",
      Married: true
    },
    {
      Name: "Pamela Moody",
      Age: 55,
      Country: 6,
      Address: "622-6233 Luctus Rd.",
      Married: true
    },
    {
      Name: "Julie Leon",
      Age: 43,
      Country: 6,
      Address: "Ap #915-6782 Sem Av.",
      Married: true
    },
    {
      Name: "Shana Nolan",
      Age: 79,
      Country: 5,
      Address: "P.O. Box 603, 899 Eu St.",
      Married: false
    },
    {
      Name: "Vaughan Moody",
      Age: 37,
      Country: 5,
      Address: "880 Erat Rd.",
      Married: false
    },
    {
      Name: "Randall Reeves",
      Age: 44,
      Country: 3,
      Address: "1819 Non Street",
      Married: false
    },
    {
      Name: "Dominic Raymond",
      Age: 68,
      Country: 1,
      Address: "Ap #689-4874 Nisi Rd.",
      Married: true
    },
    {
      Name: "Lev Pugh",
      Age: 69,
      Country: 5,
      Address: "Ap #433-6844 Auctor Avenue",
      Married: true
    },
    {
      Name: "Desiree Hughes",
      Age: 80,
      Country: 4,
      Address: "605-6645 Fermentum Avenue",
      Married: true
    },
    {
      Name: "Idona Oneill",
      Age: 23,
      Country: 7,
      Address: "751-8148 Aliquam Avenue",
      Married: true
    },
    {
      Name: "Lani Mayo",
      Age: 76,
      Country: 1,
      Address: "635-2704 Tristique St.",
      Married: true
    },
    {
      Name: "Cathleen Bonner",
      Age: 40,
      Country: 1,
      Address: "916-2910 Dolor Av.",
      Married: false
    },
    {
      Name: "Sydney Murray",
      Age: 44,
      Country: 5,
      Address: "835-2330 Fringilla St.",
      Married: false
    },
    {
      Name: "Brenna Rodriguez",
      Age: 77,
      Country: 6,
      Address: "3687 Imperdiet Av.",
      Married: true
    },
    {
      Name: "Alfreda Mcdaniel",
      Age: 38,
      Country: 7,
      Address: "745-8221 Aliquet Rd.",
      Married: true
    },
    {
      Name: "Zachery Atkins",
      Age: 30,
      Country: 1,
      Address: "549-2208 Auctor. Road",
      Married: true
    },
    {
      Name: "Amelia Rich",
      Age: 56,
      Country: 4,
      Address: "P.O. Box 734, 4717 Nunc Rd.",
      Married: false
    },
    {
      Name: "Kiayada Witt",
      Age: 62,
      Country: 3,
      Address: "Ap #735-3421 Malesuada Avenue",
      Married: false
    },
    {
      Name: "Lysandra Pierce",
      Age: 36,
      Country: 1,
      Address: "Ap #146-2835 Curabitur St.",
      Married: true
    },
    {
      Name: "Cara Rios",
      Age: 58,
      Country: 4,
      Address: "Ap #562-7811 Quam. Ave",
      Married: true
    },
    {
      Name: "Austin Andrews",
      Age: 55,
      Country: 7,
      Address: "P.O. Box 274, 5505 Sociis Rd.",
      Married: false
    },
    {
      Name: "Lillian Peterson",
      Age: 39,
      Country: 2,
      Address: "6212 A Avenue",
      Married: false
    },
    {
      Name: "Adria Beach",
      Age: 29,
      Country: 2,
      Address: "P.O. Box 183, 2717 Nunc Avenue",
      Married: true
    },
    {
      Name: "Oleg Durham",
      Age: 80,
      Country: 4,
      Address: "931-3208 Nunc Rd.",
      Married: false
    },
    {
      Name: "Casey Reese",
      Age: 60,
      Country: 4,
      Address: "383-3675 Ultrices, St.",
      Married: false
    },
    {
      Name: "Kane Burnett",
      Age: 80,
      Country: 1,
      Address: "759-8212 Dolor. Ave",
      Married: false
    },
    {
      Name: "Stewart Wilson",
      Age: 46,
      Country: 7,
      Address: "718-7845 Sagittis. Av.",
      Married: false
    },
    {
      Name: "Charity Holcomb",
      Age: 31,
      Country: 6,
      Address: "641-7892 Enim. Ave",
      Married: false
    },
    {
      Name: "Kyra Cummings",
      Age: 43,
      Country: 4,
      Address: "P.O. Box 702, 6621 Mus. Av.",
      Married: false
    },
    {
      Name: "Stuart Wallace",
      Age: 25,
      Country: 7,
      Address: "648-4990 Sed Rd.",
      Married: true
    },
    {
      Name: "Carter Clarke",
      Age: 59,
      Country: 6,
      Address: "Ap #547-2921 A Street",
      Married: false
    }
  ],
  countryData: [
    { Name: "", Id: 0 },
    { Name: "United States", Id: 1 },
    { Name: "Canada", Id: 2 },
    { Name: "United Kingdom", Id: 3 },
    { Name: "France", Id: 4 },
    { Name: "Brazil", Id: 5 },
    { Name: "China", Id: 6 },
    { Name: "Russia", Id: 7 }
  ],
  sortBy: {
    Name: 0,
    Age: 0,
    Address: 0,
    Country: 0,
    Married: 0,
    choose: ""
  },

  dataShow: [],
  choosingItem: {},
  bgChoosingItem: "",
  editActive: 1,
  size: 8,
  page: 1,
  totalRecord: 0,
  totalPage: 0,

  init() {
    this.dataShow = this.JSONData;
    this.renderSearchRow();
    this.renderHeadRow();
    this.loadData();
    this.addEventOnInit();
  },
  loadData() {
    const dataField = document.getElementById("data-field");
    let begin = -1,
      end = 0;
    dataField.textContent = null;
    this.totalRecord = this.dataShow.length;
    this.totalPage = Math.ceil(this.totalRecord / this.size);
    this.editActive = 1;
    this.choosingItem = {};
    if (this.totalPage > 0) {
      if (this.page > this.totalPage) {
        this.page = this.totalPage;
      }

      begin = (this.page - 1) * this.size;
      end = this.page * this.size;
      if (end > this.totalRecord) {
        end = this.totalRecord;
      }

      for (let index = begin; index < end; index++) {
        const trElement = document.createElement("tr");
        trElement.classList.add("row");
        trElement.setAttribute("id", `idx-${index}`);
        dataField.appendChild(trElement);
        this.renderItem(index, this.dataShow[index]);
      }
    }

    this.renderPagination(begin, end);
  },

  renderHeadRow() {
    const headRow = document.getElementsByClassName("row-head")[0];
    headRow.textContent = null;
    for (item in this.sortBy) {
      const thElement = document.createElement("th"),
        onclickAttr = document.createAttribute("onclick"),
        titleAttr = document.createAttribute("title");
      if (item != "choose") {
        onclickAttr.value = `tableCustomer.sortByKey('${item}')`;
        titleAttr.value = `Click to sort by ${item}`;
        thElement.classList.add("col", "col-head", `id-${item}`);
        thElement.setAttributeNode(onclickAttr);
        thElement.setAttributeNode(titleAttr);
        thElement.textContent = item;
      } else {
        const btnElement = document.createElement("button");
        onclickAttr.value = `tableCustomer.searchTrigger()`;
        titleAttr.value = `Hide/Show filter`;
        btnElement.classList.add("search-trigger");
        btnElement.setAttributeNode(onclickAttr);
        btnElement.setAttributeNode(titleAttr);
        btnElement.textContent = "ðŸ”„";
        thElement.classList.add("col", "col-head", "id-action");
        thElement.appendChild(btnElement);
      }
      headRow.appendChild(thElement);
    }
  },
  renderSortRow() {
    if (this.sortBy.choose) {
      let title = document.getElementsByClassName(`id-${this.sortBy.choose}`);
      let symbol = this.sortBy[this.sortBy.choose] < 1 ? "ðŸ”º" : "ðŸ”»";
      title[0].textContent = `${symbol} ${this.sortBy.choose}`;
    }
  },
  renderSearchRow() {
    const searchRow = document.getElementsByClassName("row-search")[0];
    searchRow.textContent = null;
    for (item in this.sortBy) {
      const tdElement = document.createElement("td");
      if (item != "choose") {
        const inputElement = document.createElement("input"),
          typeAttr = document.createAttribute("type"),
          titleAttr = document.createAttribute("title");

        tdElement.classList.add("col", `id-${item.toLowerCase()}`);
        titleAttr.value = `Filter with ${item}`;
        switch (item) {
          case "Name":
          case "Age":
          case "Address": {
            item === "Age"
              ? (typeAttr.value = `number`)
              : (typeAttr.value = `text`);
            inputElement.classList.add("input-control", "oninput-search");
            inputElement.setAttribute("id", `${item.toLowerCase()}-search`);
            inputElement.setAttributeNode(typeAttr);
            inputElement.setAttributeNode(titleAttr);
            tdElement.appendChild(inputElement);
            break;
          }
          case "Country": {
            const selectElement = document.createElement("select");
            selectElement.classList.add("input-control", "onchange-search");
            selectElement.setAttribute("id", `${item.toLowerCase()}-search`);
            selectElement.setAttributeNode(titleAttr);
            tdElement.appendChild(selectElement);
            break;
          }
          case "Married": {
            const nameAttr = document.createAttribute("name");
            inputElement.classList.add("onchange-search");
            inputElement.setAttribute("name", "cb-married");
            inputElement.setAttribute("type", "checkbox");
            inputElement.setAttribute("id", `cb-${item.toLowerCase()}-search`);
            inputElement.setAttributeNode(titleAttr);
            tdElement.appendChild(inputElement);
            break;
          }
        }
      } else {
        const btnElement = document.createElement("button");
        btnElement.setAttribute("id", "btn-search");
        btnElement.setAttribute("onclick", "tableCustomer.searchData()");
        btnElement.setAttribute("title", "Filter with all field");
        btnElement.textContent = `ðŸ”`;
        btnElement.classList.add("btn-control");
        tdElement.classList.add("col", "id-action");
        tdElement.appendChild(btnElement);
      }
      searchRow.appendChild(tdElement);
    }

    this.addEventToSearchRow();
  },
  renderItem(index, item) {
    const dataRow = document.getElementById(`idx-${index}`);
    dataRow.textContent = null;
    for (key in this.sortBy) {
      const tdElement = document.createElement("td");
      if (key != "choose") {
        tdElement.classList.add(
          `col`,
          `idx-${index}`,
          `id-${key.toLowerCase()}`
        );
        tdElement.setAttribute("onclick", `tableCustomer.editItem(${index})`);
        if (key === "Married") {
          const inputElement = document.createElement("input");
          inputElement.setAttribute("type", "checkbox");
          inputElement.setAttribute("id", `cb-${key.toLowerCase()}-${index}`);
          inputElement.setAttribute("name", "cb-married");
          inputElement.setAttribute("value", item[key]);
          inputElement.setAttribute("disabled", "true");
          if (item.Married) {
            inputElement.setAttribute("checked", "true");
          }
          tdElement.appendChild(inputElement);
        } else {
          tdElement.textContent =
            key === "Country" ? this.getCountryName(item[key]) : item[key];
        }
      } else {
        const spanEdit = document.createElement("span"),
          spanDelete = document.createElement("span");
        tdElement.classList.add(`col`, `idx-${index}`, `id-action`);
        spanEdit.classList.add("icon-span", "edit");
        spanDelete.classList.add("icon-span", "del");
        spanEdit.setAttribute("onclick", `tableCustomer.editItem(${index})`);
        spanEdit.setAttribute("title", `Edit item ${index}`);
        spanDelete.setAttribute(
          "onclick",
          `tableCustomer.deleteItem(${index})`
        );
        spanDelete.setAttribute("title", `Delete item ${index}`);
        spanEdit.textContent = "ðŸ“";
        spanDelete.textContent = "âŒ";
        tdElement.appendChild(spanEdit);
        tdElement.appendChild(spanDelete);
      }
      dataRow.appendChild(tdElement);
    }
  },
  renderPagination(begin, end) {
    const pageSelect = document.getElementsByClassName("page-select")[0],
      pageInformation = document.getElementsByClassName("page-information");
    let page = this.page,
      totalPage = this.totalPage,
      previous = "",
      next = "",
      pageCurrent = `<span class="page-current">${page}</span>`,
      before = "",
      after = "",
      pageLeft = 8,
      pageBefore = page - 1,
      pageAfter = page + 1,
      pagePerSide = Math.floor(pageLeft / 2),
      count;
    for (
      pageBefore, count = 1;
      pageBefore > 0 && count <= pagePerSide;
      pageBefore--, count++
    ) {
      before =
        `<a class="link link-to-page" href="#" id="page-${pageBefore}" title="Go to page ${pageBefore}" onclick="tableCustomer.goToPage(${pageBefore})">${pageBefore}</a> ` +
        before;
      pageLeft--;
    }

    for (
      pageAfter, count = 1;
      pageAfter <= totalPage && count <= pagePerSide;
      pageAfter++, count++
    ) {
      after += ` <a class="link link-to-page" href="#" id="page-${pageAfter}" title="Go to page ${pageAfter}" onclick="tableCustomer.goToPage(${pageAfter})">${pageAfter}</a>`;
      pageLeft--;
    }

    while (pageLeft > 0) {
      if (pageBefore > 0) {
        before =
          `<a class="link link-to-page" href="#" id="page-${pageBefore}" title="Go to page ${pageBefore}" onclick="tableCustomer.goToPage(${pageBefore})">${pageBefore}</a> ` +
          before;
        pageBefore--;
      }

      if (pageAfter <= totalPage) {
        after += ` <a class="link link-to-page" href="#" id="page-${pageAfter}" title="Go to page ${pageAfter}" onclick="tableCustomer.goToPage(${pageAfter})">${pageAfter}</a>`;
        pageAfter++;
      }

      pageLeft--;
    }

    if (pageBefore > 0) {
      before = "... " + before;
    }

    if (pageAfter <= totalPage) {
      after += " ...";
    }

    if (page < 2) {
      document.getElementById("first-page").style.display = "none";
    } else {
      document.getElementById("first-page").style.display = "";
      previous = `<a class="link link-to-page" href="#" id="previous-page" title="Go to page ${
        page - 1
      }">&#9664;</a>`;
    }

    if (page >= totalPage) {
      document.getElementById("last-page").style.display = "none";
    } else {
      document.getElementById("last-page").style.display = "";
      next = `<a class="link link-to-page" href="#" id="next-page" title="Go to page ${
        page + 1
      }">&#9654;</a>`;
    }

    pageSelect.innerHTML = `${previous} ${before} ${pageCurrent} ${after} ${next}`;
    pageInformation[0].textContent = `
            | Page ${page} of ${totalPage} |
            Showing ${begin + 1} to ${end} of ${this.totalRecord} records |`;
    if (previous) {
      document
        .getElementById(`previous-page`)
        .addEventListener("click", function () {
          tableCustomer.goToPage(page - 1);
        });
    }

    if (next) {
      document
        .getElementById(`next-page`)
        .addEventListener("click", function () {
          tableCustomer.goToPage(page + 1);
        });
    }
  },
  addEventOnInit() {
    const sizeControl = document.getElementById("input-size"),
      firstPage = document.getElementById("first-page"),
      lastPage = document.getElementById("last-page");

    firstPage.onclick = null;
    firstPage.onclick = function () {
      tableCustomer.goFirst();
    };
    lastPage.onclick = null;
    lastPage.onclick = function () {
      tableCustomer.goLast();
    };
    sizeControl.oninput = null;
    sizeControl.oninput = function () {
      if (!isNaN(this.value) && this.value > 1 && this.value < 50) {
        tableCustomer.size = Math.floor(this.value);
      } else {
        tableCustomer.size = 8;
        this.value = 8;
      }

      tableCustomer.loadData();
    };
  },
  addEventToSearchRow() {
    const selectCountry = document.getElementById(`country-search`),
      oninputSearch = document.getElementsByClassName("oninput-search"),
      onchangeSearch = document.getElementsByClassName("onchange-search");
    this.countryData.forEach((value) => {
      const optionElement = document.createElement("option");
      optionElement.setAttribute("value", value.Id);
      optionElement.textContent = value.Name;
      if (this.choosingItem.Country == value.Id) {
        optionElement.setAttribute("selected", "true");
      }
      selectCountry.appendChild(optionElement);
    });
    for (item in oninputSearch) {
      oninputSearch[item].oninput = null;
      oninputSearch[item].oninput = this.searchDataByKey;
    }
    for (item in onchangeSearch) {
      onchangeSearch[item].onchange = null;
      onchangeSearch[item].onchange = this.searchDataByKey;
    }
  },
  goFirst() {
    this.page = 1;
    this.loadData();
  },
  goLast() {
    this.page = this.totalPage;
    this.loadData();
  },
  goToPage(page) {
    this.page = page;
    this.loadData();
  },

  renderEditItem(index, item) {
    const editRow = document.getElementById(`idx-${index}`);
    editRow.textContent = null;
    let selectCountry;
    this.bgChoosingItem = editRow.style.backgroundColor;
    editRow.style.backgroundColor = "#fcffda";

    for (key in this.sortBy) {
      const tdElement = document.createElement("td");
      if (key != "choose") {
        const inputElement = document.createElement("input");
        tdElement.classList.add(
          "col",
          `idx-${index}`,
          `id-${key.toLowerCase()}`
        );
        switch (key) {
          case "Name":
          case "Age":
          case "Address": {
            const typeAttr = document.createAttribute("type");
            key === "Age"
              ? (typeAttr.value = `number`)
              : (typeAttr.value = `text`);
            inputElement.classList.add("input-control");
            inputElement.setAttribute("id", `${key.toLowerCase()}-${index}`);
            inputElement.setAttribute("value", item[key]);
            inputElement.setAttributeNode(typeAttr);
            tdElement.appendChild(inputElement);
            break;
          }
          case "Country": {
            const selectElement = document.createElement("select");
            selectElement.classList.add("input-control");
            selectElement.setAttribute("id", `${key.toLowerCase()}-${index}`);
            tdElement.appendChild(selectElement);
            break;
          }
          case "Married": {
            inputElement.setAttribute("type", "checkbox");
            inputElement.setAttribute("id", `cb-${key.toLowerCase()}-${index}`);
            inputElement.setAttribute("name", "cb-married");
            inputElement.setAttribute("value", item[key]);
            if (item.Married) {
              inputElement.setAttribute("checked", "true");
            }
            tdElement.setAttribute("id", `${key.toLowerCase()}-${index}`);
            tdElement.appendChild(inputElement);
            break;
          }
        }
      } else {
        tdElement.classList.remove();
        tdElement.classList.add(`col`, `idx-${index}`, `id-action`);

        const spanSave = document.createElement("span"),
          spanCancel = document.createElement("span");
        spanSave.classList.add("icon-span", "save");
        spanCancel.classList.add("icon-span", "cancel");
        spanSave.setAttribute("onclick", `tableCustomer.saveItem(${index})`);
        spanSave.setAttribute("title", `Save item ${index}`);
        spanCancel.setAttribute(
          "onclick",
          `tableCustomer.cancelEdit(${index})`
        );
        spanCancel.setAttribute("title", `Cancel edit item ${index}`);
        spanSave.textContent = "ðŸ’¾";
        spanCancel.textContent = "â›”";
        tdElement.appendChild(spanSave);
        tdElement.appendChild(spanCancel);
      }
      editRow.appendChild(tdElement);
    }

    selectCountry = document.getElementById(`country-${index}`);
    this.countryData.forEach((value) => {
      const optionElement = document.createElement("option");
      optionElement.setAttribute("value", value.Id);
      optionElement.textContent = value.Name;
      if (this.choosingItem.Country == value.Id) {
        optionElement.setAttribute("selected", "true");
      }
      selectCountry.appendChild(optionElement);
    });
  },
  editItem(index) {
    if (this.editActive) {
      this.choosingItem = this.dataShow[index];
      this.editActive = 0;
      this.renderEditItem(index, this.choosingItem);
    }
  },
  deleteItem(index) {
    if (this.editActive) {
      if (confirm(`Do you want to delete customer with index ${index + 1} ?`)) {
        let deleteItem = this.dataShow[index];
        this.JSONData.splice(this.JSONData.indexOf(deleteItem), 1);
        if (this.dataShow.indexOf(deleteItem) !== -1) {
          this.dataShow.splice(this.dataShow.indexOf(deleteItem), 1);
        }

        this.loadData();
      }
    }
  },
  saveItem(index) {
    this.choosingItem.Name = document.getElementById(`name-${index}`).value;
    this.choosingItem.Age = document.getElementById(`age-${index}`).value;
    this.choosingItem.Address = document.getElementById(
      `address-${index}`
    ).value;
    this.choosingItem.Country = document.getElementById(
      `country-${index}`
    ).value;
    this.choosingItem.Married = false;
    if (document.getElementById(`cb-married-${index}`).checked) {
      this.choosingItem.Married = true;
    }

    this.cancelEdit(index);
  },
  cancelEdit(index) {
    const editRow = document.getElementById(`idx-${index}`);
    this.renderItem(index, this.choosingItem);
    editRow.style.backgroundColor = this.bgChoosingItem;
    this.editActive = 1;
    this.choosingItem = {};
  },

  searchData() {
    this.dataShow = this.JSONData;
    this.filterDataByName(document.getElementById("name-search").value);
    this.filterDataByAge(document.getElementById("age-search").value);
    this.filterDataByAddress(document.getElementById("address-search").value);
    this.filterDataByCountry(document.getElementById("country-search").value);
    this.filterDataByMarried(document.getElementById("cb-married-search"));
    this.loadData();
  },
  searchDataByKey() {
    tableCustomer.dataShow = tableCustomer.JSONData;
    let key = this.id;
    switch (key) {
      case "name-search": {
        tableCustomer.filterDataByName(this.value);
        break;
      }
      case "age-search": {
        tableCustomer.filterDataByAge(this.value);
        break;
      }
      case "address-search": {
        tableCustomer.filterDataByAddress(this.value);
        break;
      }
      case "country-search": {
        tableCustomer.filterDataByCountry(this.value);
        break;
      }
      case "cb-married-search": {
        tableCustomer.filterDataByMarried(this);
        break;
      }
    }
    tableCustomer.loadData();
  },
  filterDataByName(value) {
    if (value) {
      this.dataShow = this.dataShow.filter((element) => {
        return element.Name.toLowerCase().includes(value.trim().toLowerCase());
      });
    }
  },
  filterDataByAddress(value) {
    if (value) {
      this.dataShow = this.dataShow.filter((element) => {
        return element.Address.toLowerCase().includes(
          value.trim().toLowerCase()
        );
      });
    }
  },
  filterDataByAge(value) {
    if (value) {
      this.dataShow = this.dataShow.filter((element) => element.Age == value);
    }
  },
  filterDataByCountry(value) {
    if (+value) {
      this.dataShow = this.dataShow.filter(
        (element) => element.Country == value
      );
    }
  },
  filterDataByMarried(value) {
    if (value.checked) {
      this.dataShow = this.dataShow.filter(
        (element) => element.Married == true
      );
    } else {
      this.dataShow = this.dataShow.filter(
        (element) => element.Married == false
      );
    }
  },
  searchTrigger() {
    const icon = document.getElementsByClassName("search-trigger"),
      rowHead = document.getElementsByClassName("row-search")[0];
    if (rowHead.style.display == "none") {
      rowHead.style.display = "";
      icon[0].textContent = "ðŸ”";
    } else {
      tableCustomer.init();
      rowHead.style.display = "none";
      icon[0].textContent = "ðŸ”„";
    }
  },

  sortByKey(key) {
    this.dataShow.sort((a, b) => (a[key] > b[key] ? -1 : 1));
    this.sortBy[key] < 1
      ? (this.sortBy[key] = 1)
      : (this.dataShow.reverse(), (this.sortBy[key] = -1));
    this.sortBy.choose = key;
    this.renderHeadRow();
    this.renderSortRow();
    this.loadData();
  },

  getCountryName(id) {
    for (item of this.countryData) {
      if (item.Id == id) {
        return item.Name;
      }
    }
  }
};

function init() {
  tableCustomer.init();
}